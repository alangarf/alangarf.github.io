<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.0 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Now we’re get’n somewhere! - Retro Challenge 2017/04 - FromOrbit.com</title>
<meta name="description" content="Things are starting to be coming up Milhouse!">


  <meta name="author" content="Alan Garfield">
  
  <meta property="article:author" content="Alan Garfield">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="FromOrbit.com">
<meta property="og:title" content="Now we’re get’n somewhere! - Retro Challenge 2017/04">
<meta property="og:url" content="https://fromorbit.com/2017/04/08/gettin-somewhere-rc201704.html">


  <meta property="og:description" content="Things are starting to be coming up Milhouse!">



  <meta property="og:image" content="https://fromorbit.com/assets/images/2017-04-08/adapters_in_place.jpg">



  <meta name="twitter:site" content="@alangarf">
  <meta name="twitter:title" content="Now we’re get’n somewhere! - Retro Challenge 2017/04">
  <meta name="twitter:description" content="Things are starting to be coming up Milhouse!">
  <meta name="twitter:url" content="https://fromorbit.com/2017/04/08/gettin-somewhere-rc201704.html">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://fromorbit.com/assets/images/2017-04-08/adapters_in_place.jpg">
  

  
    <meta name="twitter:creator" content="@alangarf">
  



  <meta property="article:published_time" content="2017-04-08T00:00:00+10:00">






<link rel="canonical" href="https://fromorbit.com/2017/04/08/gettin-somewhere-rc201704.html">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="FromOrbit.com Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          FromOrbit.com
          
        </a>
        <ul class="visible-links"></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(140, 102, 47, 0.8), rgba(140, 102, 47, 0.8)), url('/assets/images/2017-04-08/adapters_in_place.jpg');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          Now we’re get’n somewhere! - Retro Challenge 2017/04

        
      </h1>
      
        <p class="page__lead">Things are starting to be coming up Milhouse!
</p>
      
      

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


      
    </div>
  
  
</div>







<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://fromorbit.com/">
        <img src="/assets/bio.jpg" alt="Alan Garfield" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://fromorbit.com/" itemprop="url">Alan Garfield</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Generic nerd who dabbles in programming, electronics, CNC and retro computing.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      
        <li>
          <a href="https://twitter.com/alangarf" itemprop="sameAs" rel="nofollow noopener noreferrer me">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span>
          </a>
        </li>
      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/alangarf" itemprop="sameAs" rel="nofollow noopener noreferrer me">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      
        
          <li>
            <a href="https://www.youtube.com/user/randomgarfield" itemprop="sameAs" rel="nofollow noopener noreferrer me">
              <i class="fab fa-fw fa-youtube" aria-hidden="true"></i><span class="label">YouTube</span>
            </a>
          </li>
        
      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Now we’re get’n somewhere! - Retro Challenge 2017/04">
    <meta itemprop="description" content="Things are starting to be coming up Milhouse!">
    <meta itemprop="datePublished" content="2017-04-08T00:00:00+10:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
        <p>After the UV fiasco I’ve finally managed to get around the issue. I did that by
ditching EPROMs and instead replaced them with EEPROMs!</p>

<p>Rummaging around in the shed I found two other cards from the system this
controller was in originally. They were for controlling infrared devices and
what not and used a M68HC11 CPU. They had 27C64 EPROMs and 28C64s EEPROM each.</p>

<p>My guess is that rather than adding battery backed up RAM on these smaller
cards, AMX opted just to use the 28C64 as SRAM since the write performance etc
of them are pretty good. These smaller cards really didn’t store much other
than configuration data and they would’ve just used the internal 768 bytes of RAM
on chip and just set the 28C64 up as an external 8KB of non-volatile RAM.</p>

<p>Anyway, I found them and thought “Hmmm a blinking LED doesn’t need 64KBs
(2x32KB) of ROM to work, 16KBs (2x8KB) should be ample”. The only real issue I
had was that I only had two and they were from different manufacturers. I wasn’t
sure if this would cause an issue or not but I figured it would be worth a
try.</p>

<h1 id="a-try-">A try …</h1>

<p>The 28C64s are basically almost pin compatible with the 27C256s (obviously
missing the two additional address lines.</p>

<p><img src="/assets/images/2017-04-08/eeprom_vs_eprom1.png" alt="Pin outs of a 28C64 and a 27C256" class="align-center" /></p>

<p>So apart from A14, A13 and the VPP signal these would plug straight in. Woo hoo
I was thinking, this’ll be easy!</p>

<p>I set to work. I wanted to replace the crappy single leaf sockets that are on
this board, but I wasn’t willing to do all of them in one hit. The PCB traces
on the thicker tracks have started that weird bubbling/lifting thing that
things of this vintage start to do. I figured it would be safer if I just did
one set at a time. So I carefully desoldered the two sockets and replaced them
with machine pin sockets…</p>

<figure class=""><img src="/assets/images/2017-04-08/sockets_gone.jpg" alt="Removed the sockets" /><figcaption>
      Old sockets be gone!

    </figcaption></figure>

<p>It was at this time that I noticed pin 1 on these sockets had traces. Given
these are the VPP lines I thought that was strange. It turns out they’re
actually connected to A16! This isn’t a problem (yet) as the VPP lines require
high voltage to do anything.</p>

<p>The solution I came up with to make the 28C64s work without their write enable
line being connected to A14 was to add another layer of machine pins with the
sockets missing.</p>

<figure class=""><img src="/assets/images/2017-04-08/adapters_in_place.jpg" alt="Adapters in place" /><figcaption>
      Adapters in place

    </figcaption></figure>

<p>I opted to pull out the VPP, A13 and A14 pins just to make sure. I then
programmed my blink routine into the two mismatched 28C64s and expected great
things to happen… And they did… briefly…</p>

<h1 id="the-led-blinked-sometimes">THE LED BLINKED!… sometimes.</h1>

<p>After all the hassle with the EPROMS and UV light etc I <em>finally</em> had the
little LED blink. The only issue was that it wouldn’t do it consistently.
Sometimes it would blink 4 or 5 times then stop, other times it would blink
once and stay on, and others it just wouldn’t blink at all. :(</p>

<p>I started to suspect that possibly different timings with the EEPROMs vendors
and that the CPU was only <em>sometimes</em> getting it’s stars to align well enough
for the LED to blink for a few cycles etc before it got all jammed up. I wasn’t
too disappointed as I knew my element14 delivery was arriving in the morning
with my new AT28C256’s and the fact I got the board to do <em>anything</em> was a
total win in my book at this point.</p>

<p>I posted on twitter about my success and went to bed late, trying not to
disturb my lovely wife once again.</p>

<h1 id="something-fishy-is-going-on">Something fishy is going on.</h1>

<p>Through my following working day I kept being suspicious of the timing
conclusion I’d drawn myself into. It was odd that the CPU would process
hundreds of thousands of instruction reads from these EEPROMs inside the delay
loop code before “magically” the timing of the EEPROMs would became an issue
and ruined the whole thing. That started to sound very very unlikely to me. It
just didn’t make sense.</p>

<p>I then started thinking about the code, and how the interrupt and error vectors
where not set correctly in the early part of the ROM code. So if the CPU had an
external interrupt triggered by some of the other uninitialized hardware, the
CPU could be falling into an ISR that didn’t exist and lock up.</p>

<p>This started to sound more and more likely to me, so once I finished work for
the day I set about properly configuring the interrupt vector table and
cleaning up my horrible testing code.</p>

<p>I wanted the code to be relocatable and the vector table be properly configured
using a linker script so that I can link up a bunch of objects and have the
magic of linking work with me rather than it just being a dumb copy-it-here type
deal.</p>

<h1 id="building-the-code-environment">Building the code environment.</h1>

<p><a href="https://github.com/alangarf/amx_axc_m68k">https://github.com/alangarf/amx_axc_m68k</a></p>

<p>After much frustration trying to figure out why <code class="language-plaintext highlighter-rouge">ld</code> was overwriting my new
<code class="language-plaintext highlighter-rouge">.vector</code> section and my general lack of understanding of a lot of what the
linker does I enlisted the help of my dear friend
<a href="https://twitter.com/trc_wm">Niels</a> to help point me in the right direction.</p>

<p>Together we figured out my <code class="language-plaintext highlighter-rouge">.section</code> in my assembly code didn’t have the right
flags set so <code class="language-plaintext highlighter-rouge">ld</code> wasn’t loading the <code class="language-plaintext highlighter-rouge">.vector</code> section into the output. Rightly
so because it thought it didn’t have to.  After we figured that out the vectors
where properly being set, and I had a workable development setup to continue on
with.</p>

<p>I later discovered that <code class="language-plaintext highlighter-rouge">objcopy</code> also can generate interleaved binary files
just for the purpose of creating ROM files for systems like this one. So rather
than using some dodgy python I wrote quickly to split the resulting binary ROM
image in half, I simply made <code class="language-plaintext highlighter-rouge">objcopy</code> create an <em>even</em> and an <em>odd</em> ROM
image!</p>

<p>Suitably chuffed with myself at this point.</p>

<h1 id="at28c256s-arrive">AT28C256s arrive!</h1>

<p>Again, element14 in Sydney amaze me. My AT28C256s were ordered at 5:30PM the
day before, and arrived at my door in country NSW Australia by lunch time the
next day. I’m about 5 hours drive away from their warehouse (I used to live
near their warehouse and boy it was useful), so it’s truly amazing how quickly
I can get parts from them.</p>

<p>Anyway, deciding for a quick win I didn’t bother creating a pin swapping socket
for these new chips. I figured I’d just use only the first 8KB of them and drop
them into the existing sockets I had for the 28C64s.</p>

<figure class=""><img src="/assets/images/2017-04-08/at28c256s_in_place.jpg" alt="AT28C256s in place" /><figcaption>
      AT28C256s in place

    </figcaption></figure>

<p>I realized after plugging them in that had I not removed the VPP lines from
these sockets that I would’ve connected A16 to the A14 pin on these EEPROMs,
which would’ve allowed for 16KBs of ROM split across 0x0000 -&gt; 0x3FFF and
0x8000 -&gt; 0xBFFF.</p>

<p>But more importantly when I do properly do the pin swap to make these into a
continuous 64KB address space the write enable pin would end up at the VPP
position which now I know has A16 attached to it!</p>

<p>This could’ve had <strong>all sorts</strong> of weird consequences had I not known that now!</p>

<h1 id="so-did-it-work">So did it work?</h1>

<p>I powered up the board with the new EEPROMs and the updated code and <strong>success</strong>
it blinked perfectly, a nice solid consistent blink…</p>

<figure class=""><img src="/assets/images/2017-04-08/blinking1.gif" alt="Blink you good thing!" /><figcaption>
      Blink you good thing!

    </figcaption></figure>

<p>… until I lifted the board.</p>

<h1 id="ugh-youre-kidding-me">UGH, you’re kidding me.</h1>

<p>It seems like the issue I had with the other 28C64s wasn’t timing or bad code,
it was a plain and simple dry joint somewhere on this board causing all the
issues. :(</p>

<p>I mean expecting a 27 year old board that spent at least 10 years bouncing
around my garage to have no damage after all this time probably was a little
naive.</p>

<p>When testing the manufacturers firmware via a serial terminal I remember
noticing initially that sometimes the board wouldn’t boot properly or it would
crash sometimes. But even then I attributed this to a bad serial lead or the
shitty terminal emulator I had on my Windows machine in the shed.</p>

<p>So, now I have a treasure hunt on my hands. Is it a bad solder joint, or a
cracked trace somewhere on the board. I’m going to start with resolding all the
connections first, then I’ll start looking more closely at the traces. The main
issue I have is that a <strong>lot</strong> of the traces are hidden under sockets and
immovable devices so that could be fun. BUT at least now I have a working board
with a known issue. If I giggle the board just so I can make it work reliably.
So that’s a win in my book!</p>

<h1 id="what-else-have-you-done-though-what-about-that-schema">What else have you done though, what about that schema?</h1>

<p>Yeah I’ve updated the schematic some more, apart from the level conversion of
the RS232 port I’ve got the entire schematic done now. You can get the KiCAD
files from: <a href="https://github.com/alangarf/amx_axc_kicad">https://github.com/alangarf/amx_axc_kicad</a>.</p>

<p><a href="/assets/images/2017-04-08/schematic.png" class="align-center"><img src="/assets/images/2017-04-08/schematic.png" alt="The schematic" /></a></p>

<h1 id="is-that-all">Is that all?</h1>

<p>Yeah I think that’ll do for today. :)</p>


        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2017-04-08T00:00:00+10:00">April 8, 2017</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://x.com/intent/tweet?via=alangarf&text=Now+we%27re+get%27n+somewhere%21+-+Retro+Challenge+2017%2F04%20https%3A%2F%2Ffromorbit.com%2F2017%2F04%2F08%2Fgettin-somewhere-rc201704.html" class="btn btn--x" aria-label="Share on X" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on X">
    <i class="fas fa-fw fa-share-alt" aria-hidden="true"></i><span> X</span>
  </a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ffromorbit.com%2F2017%2F04%2F08%2Fgettin-somewhere-rc201704.html" class="btn btn--facebook" aria-label="Share on Facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook">
    <i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span>
  </a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://fromorbit.com/2017/04/08/gettin-somewhere-rc201704.html" class="btn btn--linkedin" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn">
    <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span>
  </a>
</section>


      
  <nav class="pagination">
    
      <a href="/2017/04/06/m68k-why-no-uv-rc201704.html" class="pagination--pager" title="Ugh! I need UV - Retro Challenge 2017/04">Previous</a>
    
    
      <a href="/2017/04/18/rinse-repeat-rc201704.html" class="pagination--pager" title="Rinse Repeat. :( - Retro Challenge 2017/04">Next</a>
    
  </nav>


    </div>

    
      
        <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="disqus_thread"></section>
    
</div>

      
    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You May Also Enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/500x300.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2025/04/25/Alan-wishlist-or-stuff-he-wants-to-remember.html" rel="permalink">Alan’s Wishlist
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">MOAR STUFF
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/2022-05-23/linear16.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/05/23/IRF510-linear-amp.html" rel="permalink">45W IRF510 HF Linear Amp
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">The little amp that could!
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/2017-04-18/mc68340.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2017/05/19/m68k-crosstool-ng.html" rel="permalink">More fun with the m68k
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Finally I achieved my goal of getting a Mandelbrot routine running on this m68k board and I learned a lot along the way
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/2017-04-18/mc68340.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2017/04/26/m68k-environment-rc201704.html" rel="permalink">m68k Environment - Retro Challenge 2017/04
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Getting down and dirty with make and gcc.
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 <a href="https://fromorbit.com">FromOrbit.com</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>







    
  <script>
    var disqus_config = function () {
      this.page.url = "https://fromorbit.com/2017/04/08/gettin-somewhere-rc201704.html";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/2017/04/08/gettin-somewhere-rc201704"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://fromorbit-com.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  




  </body>
</html>
